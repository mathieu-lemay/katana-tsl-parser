#! /bin/bash

set -eu -o pipefail

fmt="${1:?}"
file="${2:?}"
idx_a="${3:?}"
idx_b="${4:-$((idx_a+1))}"

apply() {
    jq ".data[0][$1] | ${fmt}" < "${file}" | json-struct
}

colordiff -u <(apply "${idx_a}") <(apply "${idx_b}")
